
allprojects {
    apply plugin: 'idea'
}

ideaProject {
    wildcards += ['?*.gradle']
    javaVersion = '1.6'

    withXml { provider ->
        provider.node.component.find { it.@name == 'VcsDirectoryMappings' }.mapping.@vcs = 'Git'
    }

    beforeConfigured { project ->
        project.modulePaths.clear()
    }
}

ideaWorkspace {
}

subprojects {
    ideaModule {
        downloadJavadoc = false
        downloadSources = true

        outputDir = new File(buildDir, 'idea/production')
        testOutputDir = new File(buildDir, 'idea/test')

        variables = [
            'USER_HOME' : new File(System.getProperty('user.home'))
        ]

        beforeConfigured { module ->
            module.dependencies.clear()
        }
    }
}
