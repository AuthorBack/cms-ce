(function(E){var D=E.DOM,B=E.dom.Event,H=E.extend,F=E.each,A=E.util.Cookie,G,C=E.explode;E.ThemeManager.requireLangPack("advanced");E.create("tinymce.themes.AdvancedTheme",{sizes:[8,10,12,14,18,24,36],controls:{bold:["bold_desc","Bold"],italic:["italic_desc","Italic"],underline:["underline_desc","Underline"],strikethrough:["striketrough_desc","Strikethrough"],justifyleft:["justifyleft_desc","JustifyLeft"],justifycenter:["justifycenter_desc","JustifyCenter"],justifyright:["justifyright_desc","JustifyRight"],justifyfull:["justifyfull_desc","JustifyFull"],bullist:["bullist_desc","InsertUnorderedList"],numlist:["numlist_desc","InsertOrderedList"],outdent:["outdent_desc","Outdent"],indent:["indent_desc","Indent"],cut:["cut_desc","Cut"],copy:["copy_desc","Copy"],paste:["paste_desc","Paste"],undo:["undo_desc","Undo"],redo:["redo_desc","Redo"],link:["link_desc","mceLink"],unlink:["unlink_desc","unlink"],image:["image_desc","mceImage"],cleanup:["cleanup_desc","mceCleanup"],help:["help_desc","mceHelp"],code:["code_desc","mceCodeEditor"],hr:["hr_desc","InsertHorizontalRule"],removeformat:["removeformat_desc","RemoveFormat"],sub:["sub_desc","subscript"],sup:["sup_desc","superscript"],forecolor:["forecolor_desc","ForeColor"],forecolorpicker:["forecolor_desc","mceForeColor"],backcolor:["backcolor_desc","HiliteColor"],backcolorpicker:["backcolor_desc","mceBackColor"],charmap:["charmap_desc","mceCharMap"],visualaid:["visualaid_desc","mceToggleVisualAid"],anchor:["anchor_desc","mceInsertAnchor"],newdocument:["newdocument_desc","mceNewDocument"],blockquote:["blockquote_desc","mceBlockQuote"]},stateControls:["bold","italic","underline","strikethrough","bullist","numlist","justifyleft","justifycenter","justifyright","justifyfull","sub","sup","blockquote"],init:function(J,K){var L=this,M,I,N;L.editor=J;L.url=K;L.onResolveName=new E.util.Dispatcher(this);J.forcedHighContrastMode=J.settings.detect_highcontrast&&L._isHighContrast();J.settings.skin=J.forcedHighContrastMode?"highcontrast":J.settings.skin;L.settings=M=H({theme_advanced_path:true,theme_advanced_toolbar_location:"bottom",theme_advanced_buttons1:"bold,italic,underline,strikethrough,|,justifyleft,justifycenter,justifyright,justifyfull,|,styleselect,formatselect",theme_advanced_buttons2:"bullist,numlist,|,outdent,indent,|,undo,redo,|,link,unlink,anchor,image,cleanup,help,code",theme_advanced_buttons3:"hr,removeformat,visualaid,|,sub,sup,|,charmap",theme_advanced_blockformats:"p,address,pre,h1,h2,h3,h4,h5,h6",theme_advanced_toolbar_align:"center",theme_advanced_fonts:"Andale Mono=andale mono,times;Arial=arial,helvetica,sans-serif;Arial Black=arial black,avant garde;Book Antiqua=book antiqua,palatino;Comic Sans MS=comic sans ms,sans-serif;Courier New=courier new,courier;Georgia=georgia,palatino;Helvetica=helvetica;Impact=impact,chicago;Symbol=symbol;Tahoma=tahoma,arial,helvetica,sans-serif;Terminal=terminal,monaco;Times New Roman=times new roman,times;Trebuchet MS=trebuchet ms,geneva;Verdana=verdana,geneva;Webdings=webdings;Wingdings=wingdings,zapf dingbats",theme_advanced_more_colors:1,theme_advanced_row_height:23,theme_advanced_resize_horizontal:1,theme_advanced_resizing_use_cookie:1,theme_advanced_font_sizes:"1,2,3,4,5,6,7",theme_advanced_font_selector:"span",theme_advanced_show_current_color:0,readonly:J.settings.readonly},J.settings);if(!M.font_size_style_values){M.font_size_style_values="8pt,10pt,12pt,14pt,18pt,24pt,36pt"}if(E.is(M.theme_advanced_font_sizes,"string")){M.font_size_style_values=E.explode(M.font_size_style_values);M.font_size_classes=E.explode(M.font_size_classes||"");N={};J.settings.theme_advanced_font_sizes=M.theme_advanced_font_sizes;F(J.getParam("theme_advanced_font_sizes","","hash"),function(Q,P){var O;if(P==Q&&Q>=1&&Q<=7){P=Q+" ("+L.sizes[Q-1]+"pt)";O=M.font_size_classes[Q-1];Q=M.font_size_style_values[Q-1]||(L.sizes[Q-1]+"pt")}if(/^\s*\./.test(Q)){O=Q.replace(/\./g,"")}N[P]=O?{"class":O}:{fontSize:Q}});M.theme_advanced_font_sizes=N}if((I=M.theme_advanced_path_location)&&I!="none"){M.theme_advanced_statusbar_location=M.theme_advanced_path_location}if(M.theme_advanced_statusbar_location=="none"){M.theme_advanced_statusbar_location=0}if(J.settings.content_css!==false){J.contentCSS.push(J.baseURI.toAbsolute(K+"/skins/"+J.settings.skin+"/content.css"))}J.onInit.add(function(){if(!J.settings.readonly){J.onNodeChange.add(L._nodeChanged,L);J.onKeyUp.add(L._updateUndoStatus,L);J.onMouseUp.add(L._updateUndoStatus,L);J.dom.bind(J.dom.getRoot(),"dragend",function(){L._updateUndoStatus(J)})}});J.onSetProgressState.add(function(Q,O,R){var S,T=Q.id,P;if(O){L.progressTimer=setTimeout(function(){S=Q.getContainer();S=S.insertBefore(D.create("DIV",{style:"position:relative"}),S.firstChild);P=D.get(Q.id+"_tbl");D.add(S,"div",{id:T+"_blocker","class":"mceBlocker",style:{width:P.clientWidth+2,height:P.clientHeight+2}});D.add(S,"div",{id:T+"_progress","class":"mceProgress",style:{left:P.clientWidth/2,top:P.clientHeight/2}})},R||0)}else{D.remove(T+"_blocker");D.remove(T+"_progress");clearTimeout(L.progressTimer)}});D.loadCSS(M.editor_css?J.documentBaseURI.toAbsolute(M.editor_css):K+"/skins/"+J.settings.skin+"/ui.css");if(M.skin_variant){D.loadCSS(K+"/skins/"+J.settings.skin+"/ui_"+M.skin_variant+".css")}},_isHighContrast:function(){var I,J=D.add(D.getRoot(),"div",{style:"background-color: rgb(171,239,86);"});I=(D.getStyle(J,"background-color",true)+"").toLowerCase().replace(/ /g,"");D.remove(J);return I!="rgb(171,239,86)"&&I!="#abef56"},createControl:function(L,I){var J,K;if(K=I.createControl(L)){return K}switch(L){case"styleselect":return this._createStyleSelect();case"formatselect":return this._createBlockFormats();case"fontselect":return this._createFontSelect();case"fontsizeselect":return this._createFontSizeSelect();case"forecolor":return this._createForeColorMenu();case"backcolor":return this._createBackColorMenu()}if((J=this.controls[L])){return I.createButton(L,{title:"advanced."+J[0],cmd:J[1],ui:J[2],value:J[3]})}},execCommand:function(K,J,L){var I=this["_"+K];if(I){I.call(this,J,L);return true}return false},_importClasses:function(K){var I=this.editor,J=I.controlManager.get("styleselect");if(J.getLength()==0){F(I.dom.getClasses(),function(N,L){var M="style_"+L;I.formatter.register(M,{inline:"span",attributes:{"class":N["class"]},selector:"*"});J.add(N["class"],M)})}},_createStyleSelect:function(M){var K=this,I=K.editor,J=I.controlManager,L;L=J.createListBox("styleselect",{title:"advanced.style_select",onselect:function(O){var P,N=[];F(L.items,function(Q){N.push(Q.value)});I.focus();I.undoManager.add();P=I.formatter.matchAll(N);if(!O||P[0]==O){if(P[0]){I.formatter.remove(P[0])}}else{I.formatter.apply(O)}I.undoManager.add();I.nodeChanged();return false}});I.onInit.add(function(){var O=0,N=I.getParam("style_formats");if(N){F(N,function(P){var Q,R=0;F(P,function(){R++});if(R>1){Q=P.name=P.name||"style_"+(O++);I.formatter.register(Q,P);L.add(P.title,Q)}else{L.add(P.title)}})}else{F(I.getParam("theme_advanced_styles","","hash"),function(R,Q){var P;if(R){P="style_"+(O++);I.formatter.register(P,{inline:"span",classes:R,selector:"*"});L.add(K.editor.translate(Q),P)}})}});if(L.getLength()==0){L.onPostRender.add(function(N,O){if(!L.NativeListBox){B.add(O.id+"_text","focus",K._importClasses,K);B.add(O.id+"_text","mousedown",K._importClasses,K);B.add(O.id+"_open","focus",K._importClasses,K);B.add(O.id+"_open","mousedown",K._importClasses,K)}else{B.add(O.id,"focus",K._importClasses,K)}})}return L},_createFontSelect:function(){var K,J=this,I=J.editor;K=I.controlManager.createListBox("fontselect",{title:"advanced.fontdefault",onselect:function(L){var M=K.items[K.selectedIndex];if(!L&&M){I.execCommand("FontName",false,M.value);return }I.execCommand("FontName",false,L);K.select(function(N){return L==N});if(M&&M.value==L){K.select(null)}return false}});if(K){F(I.getParam("theme_advanced_fonts",J.settings.theme_advanced_fonts,"hash"),function(M,L){K.add(I.translate(L),M,{style:M.indexOf("dings")==-1?"font-family:"+M:""})})}return K},_createFontSizeSelect:function(){var L=this,J=L.editor,M,K=0,I=[];M=J.controlManager.createListBox("fontsizeselect",{title:"advanced.font_size",onselect:function(N){var O=M.items[M.selectedIndex];if(!N&&O){O=O.value;if(O["class"]){J.formatter.toggle("fontsize_class",{value:O["class"]});J.undoManager.add();J.nodeChanged()}else{J.execCommand("FontSize",false,O.fontSize)}return }if(N["class"]){J.focus();J.undoManager.add();J.formatter.toggle("fontsize_class",{value:N["class"]});J.undoManager.add();J.nodeChanged()}else{J.execCommand("FontSize",false,N.fontSize)}M.select(function(P){return N==P});if(O&&(O.value.fontSize==N.fontSize||O.value["class"]==N["class"])){M.select(null)}return false}});if(M){F(L.settings.theme_advanced_font_sizes,function(O,N){var P=O.fontSize;if(P>=1&&P<=7){P=L.sizes[parseInt(P)-1]+"pt"}M.add(N,O,{style:"font-size:"+P,"class":"mceFontSize"+(K++)+(" "+(O["class"]||""))})})}return M},_createBlockFormats:function(){var K,I={p:"advanced.paragraph",address:"advanced.address",pre:"advanced.pre",h1:"advanced.h1",h2:"advanced.h2",h3:"advanced.h3",h4:"advanced.h4",h5:"advanced.h5",h6:"advanced.h6",div:"advanced.div",blockquote:"advanced.blockquote",code:"advanced.code",dt:"advanced.dt",dd:"advanced.dd",samp:"advanced.samp"},J=this;K=J.editor.controlManager.createListBox("formatselect",{title:"advanced.block",onselect:function(L){J.editor.execCommand("FormatBlock",false,L);return false}});if(K){F(J.editor.getParam("theme_advanced_blockformats",J.settings.theme_advanced_blockformats,"hash"),function(M,L){K.add(J.editor.translate(L!=M?L:I[M]),M,{"class":"mce_formatPreview mce_"+M})})}return K},_createForeColorMenu:function(){var M,J=this,K=J.settings,L={},I;if(K.theme_advanced_more_colors){L.more_colors_func=function(){J._mceColorPicker(0,{color:M.value,func:function(N){M.setColor(N)}})}}if(I=K.theme_advanced_text_colors){L.colors=I}if(K.theme_advanced_default_foreground_color){L.default_color=K.theme_advanced_default_foreground_color}L.title="advanced.forecolor_desc";L.cmd="ForeColor";L.scope=this;M=J.editor.controlManager.createColorSplitButton("forecolor",L);return M},_createBackColorMenu:function(){var M,J=this,K=J.settings,L={},I;if(K.theme_advanced_more_colors){L.more_colors_func=function(){J._mceColorPicker(0,{color:M.value,func:function(N){M.setColor(N)}})}}if(I=K.theme_advanced_background_colors){L.colors=I}if(K.theme_advanced_default_background_color){L.default_color=K.theme_advanced_default_background_color}L.title="advanced.backcolor_desc";L.cmd="HiliteColor";L.scope=this;M=J.editor.controlManager.createColorSplitButton("backcolor",L);return M},renderUI:function(K){var M,L,N,Q=this,O=Q.editor,R=Q.settings,P,J,I;if(O.settings){O.settings.aria_label=R.aria_label+O.getLang("advanced.help_shortcut")}M=J=D.create("span",{role:"application","aria-labelledby":O.id+"_voice",id:O.id+"_parent","class":"mceEditor "+O.settings.skin+"Skin"+(R.skin_variant?" "+O.settings.skin+"Skin"+Q._ufirst(R.skin_variant):"")});D.add(M,"span",{"class":"mceVoiceLabel",style:"display:none;",id:O.id+"_voice"},R.aria_label);if(!D.boxModel){M=D.add(M,"div",{"class":"mceOldBoxModel"})}M=P=D.add(M,"table",{role:"presentation",id:O.id+"_tbl","class":"mceLayout",cellSpacing:0,cellPadding:0});M=N=D.add(M,"tbody");switch((R.theme_advanced_layout_manager||"").toLowerCase()){case"rowlayout":L=Q._rowLayout(R,N,K);break;case"customlayout":L=O.execCallback("theme_advanced_custom_layout",R,N,K,J);break;default:L=Q._simpleLayout(R,N,K,J)}M=K.targetNode;I=P.rows;D.addClass(I[0],"mceFirst");D.addClass(I[I.length-1],"mceLast");F(D.select("tr",N),function(S){D.addClass(S.firstChild,"mceFirst");D.addClass(S.childNodes[S.childNodes.length-1],"mceLast")});if(D.get(R.theme_advanced_toolbar_container)){D.get(R.theme_advanced_toolbar_container).appendChild(J)}else{D.insertAfter(J,M)}B.add(O.id+"_path_row","click",function(S){S=S.target;if(S.nodeName=="A"){Q._sel(S.className.replace(/^.*mcePath_([0-9]+).*$/,"$1"));return B.cancel(S)}});if(!O.getParam("accessibility_focus")){B.add(D.add(J,"a",{href:"#"},"<!-- IE -->"),"focus",function(){tinyMCE.get(O.id).focus()})}if(R.theme_advanced_toolbar_location=="external"){K.deltaHeight=0}Q.deltaHeight=K.deltaHeight;K.targetNode=null;O.onKeyDown.add(function(U,S){var V=121,T=122;if(S.altKey){if(S.keyCode===V){Q.toolbarGroup.focus();return B.cancel(S)}else{if(S.keyCode===T){D.get(U.id+"_path_row").focus();return B.cancel(S)}}}});O.addShortcut("alt+0","","mceShortcuts",Q);return{iframeContainer:L,editorContainer:O.id+"_parent",sizeContainer:P,deltaHeight:K.deltaHeight}},getInfo:function(){return{longname:"Advanced theme",author:"Moxiecode Systems AB",authorurl:"http://tinymce.moxiecode.com",version:E.majorVersion+"."+E.minorVersion}},resizeBy:function(I,J){var K=D.get(this.editor.id+"_ifr");this.resizeTo(K.clientWidth+I,K.clientHeight+J)},resizeTo:function(I,M,K){var J=this.editor,L=this.settings,N=D.get(J.id+"_tbl"),O=D.get(J.id+"_ifr");I=Math.max(L.theme_advanced_resizing_min_width||100,I);M=Math.max(L.theme_advanced_resizing_min_height||100,M);I=Math.min(L.theme_advanced_resizing_max_width||65535,I);M=Math.min(L.theme_advanced_resizing_max_height||65535,M);D.setStyle(N,"height","");D.setStyle(O,"height",M);if(L.theme_advanced_resize_horizontal){D.setStyle(N,"width","");D.setStyle(O,"width",I);if(I<N.clientWidth){I=N.clientWidth;D.setStyle(O,"width",N.clientWidth)}}if(K&&L.theme_advanced_resizing_use_cookie){A.setHash("TinyMCE_"+J.id+"_size",{cw:I,ch:M})}},destroy:function(){var I=this.editor.id;B.clear(I+"_resize");B.clear(I+"_path_row");B.clear(I+"_external_close")},_simpleLayout:function(T,O,K,I){var S=this,P=S.editor,Q=T.theme_advanced_toolbar_location,M=T.theme_advanced_statusbar_location,L,J,N,R;if(T.readonly){L=D.add(O,"tr");L=J=D.add(L,"td",{"class":"mceIframeContainer"});return J}if(Q=="top"){S._addToolbars(O,K)}if(Q=="external"){L=R=D.create("div",{style:"position:relative"});L=D.add(L,"div",{id:P.id+"_external","class":"mceExternalToolbar"});D.add(L,"a",{id:P.id+"_external_close",href:"javascript:;","class":"mceExternalClose"});L=D.add(L,"table",{id:P.id+"_tblext",cellSpacing:0,cellPadding:0});N=D.add(L,"tbody");if(I.firstChild.className=="mceOldBoxModel"){I.firstChild.appendChild(R)}else{I.insertBefore(R,I.firstChild)}S._addToolbars(N,K);P.onMouseUp.add(function(){var V=D.get(P.id+"_external");D.show(V);D.hide(G);var U=B.add(P.id+"_external_close","click",function(){D.hide(P.id+"_external");B.remove(P.id+"_external_close","click",U)});D.show(V);D.setStyle(V,"top",0-D.getRect(P.id+"_tblext").h-1);D.hide(V);D.show(V);V.style.filter="";G=P.id+"_external";V=null})}if(M=="top"){S._addStatusBar(O,K)}if(!T.theme_advanced_toolbar_container){L=D.add(O,"tr");L=J=D.add(L,"td",{"class":"mceIframeContainer"})}if(Q=="bottom"){S._addToolbars(O,K)}if(M=="bottom"){S._addStatusBar(O,K)}return J},_rowLayout:function(S,M,K){var R=this,N=R.editor,Q,T,I=N.controlManager,L,J,P,O;Q=S.theme_advanced_containers_default_class||"";T=S.theme_advanced_containers_default_align||"center";F(C(S.theme_advanced_containers||""),function(W,V){var U=S["theme_advanced_container_"+W]||"";switch(U.toLowerCase()){case"mceeditor":L=D.add(M,"tr");L=J=D.add(L,"td",{"class":"mceIframeContainer"});break;case"mceelementpath":R._addStatusBar(M,K);break;default:O=(S["theme_advanced_container_"+W+"_align"]||T).toLowerCase();O="mce"+R._ufirst(O);L=D.add(D.add(M,"tr"),"td",{"class":"mceToolbar "+(S["theme_advanced_container_"+W+"_class"]||Q)+" "+O||T});P=I.createToolbar("toolbar"+V);R._addControls(U,P);D.setHTML(L,P.renderHTML());K.deltaHeight-=S.theme_advanced_row_height}});return J},_addControls:function(J,I){var K=this,L=K.settings,M,N=K.editor.controlManager;if(L.theme_advanced_disable&&!K._disabled){M={};F(C(L.theme_advanced_disable),function(O){M[O]=1});K._disabled=M}else{M=K._disabled}F(C(J),function(P){var O;if(M&&M[P]){return }if(P=="tablecontrols"){F(["table","|","row_props","cell_props","|","row_before","row_after","delete_row","|","col_before","col_after","delete_col","|","split_cells","merge_cells"],function(Q){Q=K.createControl(Q,N);if(Q){I.add(Q)}});return }O=K.createControl(P,N);if(O){I.add(O)}})},_addToolbars:function(R,J){var U=this,M,L,O=U.editor,V=U.settings,T,I=O.controlManager,P,K,N=[],S,Q;Q=I.createToolbarGroup("toolbargroup",{name:O.getLang("advanced.toolbar"),tab_focus_toolbar:O.getParam("theme_advanced_tab_focus_toolbar")});U.toolbarGroup=Q;S=V.theme_advanced_toolbar_align.toLowerCase();S="mce"+U._ufirst(S);K=D.add(D.add(R,"tr",{role:"presentation"}),"td",{"class":"mceToolbar "+S,role:"presentation"});for(M=1;(T=V["theme_advanced_buttons"+M]);M++){L=I.createToolbar("toolbar"+M,{"class":"mceToolbarRow"+M});if(V["theme_advanced_buttons"+M+"_add"]){T+=","+V["theme_advanced_buttons"+M+"_add"]}if(V["theme_advanced_buttons"+M+"_add_before"]){T=V["theme_advanced_buttons"+M+"_add_before"]+","+T}U._addControls(T,L);Q.add(L);J.deltaHeight-=V.theme_advanced_row_height}N.push(Q.renderHTML());N.push(D.createHTML("a",{href:"#",accesskey:"z",title:O.getLang("advanced.toolbar_focus"),onfocus:"tinyMCE.getInstanceById('"+O.id+"').focus();"},"<!-- IE -->"));D.setHTML(K,N.join(""))},_addStatusBar:function(M,J){var K,Q=this,N=Q.editor,R=Q.settings,I,O,P,L;K=D.add(M,"tr");K=L=D.add(K,"td",{"class":"mceStatusbar"});K=D.add(K,"div",{id:N.id+"_path_row",role:"group","aria-labelledby":N.id+"_path_voice"});if(R.theme_advanced_path){D.add(K,"span",{id:N.id+"_path_voice"},N.translate("advanced.path"));D.add(K,"span",{},": ")}else{D.add(K,"span",{},"&#160;")}if(R.theme_advanced_resizing){D.add(L,"a",{id:N.id+"_resize",href:"javascript:;",onclick:"return false;","class":"mceResize"});if(R.theme_advanced_resizing_use_cookie){N.onPostRender.add(function(){var S=A.getHash("TinyMCE_"+N.id+"_size"),T=D.get(N.id+"_tbl");if(!S){return }Q.resizeTo(S.cw,S.ch)})}N.onPostRender.add(function(){B.add(N.id+"_resize","click",function(S){S.preventDefault()});B.add(N.id+"_resize","mousedown",function(d){var W,U,V,T,c,Z,a,g,S,f,X;function Y(h){h.preventDefault();S=a+(h.screenX-c);f=g+(h.screenY-Z);Q.resizeTo(S,f)}function b(h){B.remove(D.doc,"mousemove",W);B.remove(N.getDoc(),"mousemove",U);B.remove(D.doc,"mouseup",V);B.remove(N.getDoc(),"mouseup",T);S=a+(h.screenX-c);f=g+(h.screenY-Z);Q.resizeTo(S,f,true)}d.preventDefault();c=d.screenX;Z=d.screenY;X=D.get(Q.editor.id+"_ifr");a=S=X.clientWidth;g=f=X.clientHeight;W=B.add(D.doc,"mousemove",Y);U=B.add(N.getDoc(),"mousemove",Y);V=B.add(D.doc,"mouseup",b);T=B.add(N.getDoc(),"mouseup",b)})})}J.deltaHeight-=21;K=M=null},_updateUndoStatus:function(J){var I=J.controlManager;I.setDisabled("undo",!J.undoManager.hasUndo()&&!J.typing);I.setDisabled("redo",!J.undoManager.hasRedo())},_nodeChanged:function(M,P,Y,O,Z){var T=this,X,a=0,S,b,U=T.settings,R,K,Q,W,L,J,I;E.each(T.stateControls,function(d){P.setActive(d,M.queryCommandState(T.controls[d][1]))});function N(d){var e,c=Z.parents,f=d;if(typeof (d)=="string"){f=function(g){return g.nodeName==d}}for(e=0;e<c.length;e++){if(f(c[e])){return c[e]}}}P.setActive("visualaid",M.hasVisual);T._updateUndoStatus(M);P.setDisabled("outdent",!M.queryCommandState("Outdent"));X=N("A");if(b=P.get("link")){if(!X||!X.name){b.setDisabled(!X&&O);b.setActive(!!X)}}if(b=P.get("unlink")){b.setDisabled(!X&&O);b.setActive(!!X&&!X.name)}if(b=P.get("anchor")){b.setActive(!O&&!!X&&X.name)}X=N("IMG");if(b=P.get("image")){b.setActive(!O&&!!X&&Y.className.indexOf("mceItem")==-1)}if(b=P.get("styleselect")){T._importClasses();J=[];F(b.items,function(c){J.push(c.value)});I=M.formatter.matchAll(J);b.select(I[0])}if(b=P.get("formatselect")){X=N(D.isBlock);if(X){b.select(X.nodeName.toLowerCase())}}N(function(c){if(c.nodeName==="SPAN"){if(!R&&c.className){R=c.className}}if(M.dom.is(c,U.theme_advanced_font_selector)){if(!K&&c.style.fontSize){K=c.style.fontSize}if(!Q&&c.style.fontFamily){Q=c.style.fontFamily.replace(/[\"\']+/g,"").replace(/^([^,]+).*/,"$1").toLowerCase()}if(!W&&c.style.color){W=c.style.color}if(!L&&c.style.backgroundColor){L=c.style.backgroundColor}}return false});if(b=P.get("fontselect")){b.select(function(c){return c.replace(/^([^,]+).*/,"$1").toLowerCase()==Q})}if(b=P.get("fontsizeselect")){if(U.theme_advanced_runtime_fontsize&&!K&&!R){K=M.dom.getStyle(Y,"fontSize",true)}b.select(function(c){if(c.fontSize&&c.fontSize===K){return true}if(c["class"]&&c["class"]===R){return true}})}if(U.theme_advanced_show_current_color){function V(d,c){if(b=P.get(d)){if(!c){c=b.settings.default_color}if(c!==b.value){b.displayColor(c)}}}V("forecolor",W);V("backcolor",L)}if(U.theme_advanced_show_current_color){function V(d,c){if(b=P.get(d)){if(!c){c=b.settings.default_color}if(c!==b.value){b.displayColor(c)}}}V("forecolor",W);V("backcolor",L)}if(U.theme_advanced_path&&U.theme_advanced_statusbar_location){X=D.get(M.id+"_path")||D.add(M.id+"_path_row","span",{id:M.id+"_path"});if(T.statusKeyboardNavigation){T.statusKeyboardNavigation.destroy();T.statusKeyboardNavigation=null}D.setHTML(X,"");N(function(g){var c=g.nodeName.toLowerCase(),d,f,e="";if(g.getAttribute("data-mce-bogus")){return }if(g.nodeType!=1||g.nodeName==="BR"||(D.hasClass(g,"mceItemHidden")||D.hasClass(g,"mceItemRemoved"))){return }if(E.isIE&&g.scopeName!=="HTML"){c=g.scopeName+":"+c}c=c.replace(/mce\:/g,"");switch(c){case"b":c="strong";break;case"i":c="em";break;case"img":if(S=D.getAttrib(g,"src")){e+="src: "+S+" "}break;case"a":if(S=D.getAttrib(g,"name")){e+="name: "+S+" ";c+="#"+S}if(S=D.getAttrib(g,"href")){e+="href: "+S+" "}break;case"font":if(S=D.getAttrib(g,"face")){e+="font: "+S+" "}if(S=D.getAttrib(g,"size")){e+="size: "+S+" "}if(S=D.getAttrib(g,"color")){e+="color: "+S+" "}break;case"span":if(S=D.getAttrib(g,"style")){e+="style: "+S+" "}break}if(S=D.getAttrib(g,"id")){e+="id: "+S+" "}if(S=g.className){S=S.replace(/\b\s*(webkit|mce|Apple-)\w+\s*\b/g,"");if(S){e+="class: "+S+" ";if(D.isBlock(g)||c=="img"||c=="span"){c+="."+S}}}c=c.replace(/(html:)/g,"");c={name:c,node:g,title:e};T.onResolveName.dispatch(T,c);e=c.title;c=c.name;f=D.create("a",{href:"javascript:;",role:"button",onmousedown:"return false;",title:e,"class":"mcePath_"+(a++)},c);if(X.hasChildNodes()){X.insertBefore(D.create("span",{"aria-hidden":"true"},"\u00a0\u00bb "),X.firstChild);X.insertBefore(f,X.firstChild)}else{X.appendChild(f)}},M.getBody());if(D.select("a",X).length>0){T.statusKeyboardNavigation=new E.ui.KeyboardNavigation({root:M.id+"_path_row",items:D.select("a",X),excludeFromTabOrder:true,onCancel:function(){M.focus()}},D)}}},_sel:function(I){this.editor.execCommand("mceSelectNodeDepth",false,I)},_mceInsertAnchor:function(K,J){var I=this.editor;I.windowManager.open({url:this.url+"/anchor.htm",width:320+parseInt(I.getLang("advanced.anchor_delta_width",0)),height:90+parseInt(I.getLang("advanced.anchor_delta_height",0)),inline:true},{theme_url:this.url})},_mceCharMap:function(){var I=this.editor;I.windowManager.open({url:this.url+"/charmap.htm",width:550+parseInt(I.getLang("advanced.charmap_delta_width",0)),height:250+parseInt(I.getLang("advanced.charmap_delta_height",0)),inline:true},{theme_url:this.url})},_mceHelp:function(){var I=this.editor;I.windowManager.open({url:this.url+"/about.htm",width:480,height:380,inline:true},{theme_url:this.url})},_mceShortcuts:function(){var I=this.editor;I.windowManager.open({url:this.url+"/shortcuts.htm",width:480,height:380,inline:true},{theme_url:this.url})},_mceColorPicker:function(K,J){var I=this.editor;J=J||{};I.windowManager.open({url:this.url+"/color_picker.htm",width:375+parseInt(I.getLang("advanced.colorpicker_delta_width",0)),height:250+parseInt(I.getLang("advanced.colorpicker_delta_height",0)),close_previous:false,inline:true},{input_color:J.color,func:J.func,theme_url:this.url})},_mceCodeEditor:function(J,K){var I=this.editor;I.windowManager.open({url:this.url+"/source_editor.htm",width:parseInt(I.getParam("theme_advanced_source_editor_width",720)),height:parseInt(I.getParam("theme_advanced_source_editor_height",580)),inline:true,resizable:true,maximizable:true},{theme_url:this.url})},_mceImage:function(J,K){var I=this.editor;if(I.dom.getAttrib(I.selection.getNode(),"class").indexOf("mceItem")!=-1){return }I.windowManager.open({url:this.url+"/image.htm",width:355+parseInt(I.getLang("advanced.image_delta_width",0)),height:275+parseInt(I.getLang("advanced.image_delta_height",0)),inline:true},{theme_url:this.url})},_mceLink:function(J,K){var I=this.editor;I.windowManager.open({url:this.url+"/link.htm",width:310+parseInt(I.getLang("advanced.link_delta_width",0)),height:200+parseInt(I.getLang("advanced.link_delta_height",0)),inline:true},{theme_url:this.url})},_mceNewDocument:function(){var I=this.editor;I.windowManager.confirm("advanced.newdocument",function(J){if(J){I.execCommand("mceSetContent",false,"")}})},_mceForeColor:function(){var I=this;this._mceColorPicker(0,{color:I.fgColor,func:function(J){I.fgColor=J;I.editor.execCommand("ForeColor",false,J)}})},_mceBackColor:function(){var I=this;this._mceColorPicker(0,{color:I.bgColor,func:function(J){I.bgColor=J;I.editor.execCommand("HiliteColor",false,J)}})},_ufirst:function(I){return I.substring(0,1).toUpperCase()+I.substring(1)}});E.ThemeManager.add("advanced",E.themes.AdvancedTheme)}(tinymce));