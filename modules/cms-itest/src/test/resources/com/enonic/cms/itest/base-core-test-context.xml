<?xml version="1.0" encoding="UTF-8"?>
<!--
  ~ Copyright 2000-2011 Enonic AS
  ~ http://www.enonic.com/license
  -->

<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:context="http://www.springframework.org/schema/context"
       xsi:schemaLocation="http://www.springframework.org/schema/beans
       http://www.springframework.org/schema/beans/spring-beans-2.5.xsd http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-3.1.xsd">

  <import resource="classpath:/com/enonic/cms/itest/base-persist-test-context.xml"/>

  <context:component-scan base-package="com.enonic.cms.itest"/>
  <context:component-scan base-package="com.enonic.cms.core.calendar"/>
  <context:component-scan base-package="com.enonic.cms.core.captcha"/>
  <context:component-scan base-package="com.enonic.cms.core.content"/>
  <context:component-scan base-package="com.enonic.cms.core.country"/>
  <context:component-scan base-package="com.enonic.cms.core.elastic"/>
  <context:component-scan base-package="com.enonic.cms.core.http"/>
  <context:component-scan base-package="com.enonic.cms.core.image.cache"/>
  <context:component-scan base-package="com.enonic.cms.core.log"/>
  <context:component-scan base-package="com.enonic.cms.core.locale"/>
  <context:component-scan base-package="com.enonic.cms.core.localization"/>
  <context:component-scan base-package="com.enonic.cms.core.portal.instruction"/>
  <context:component-scan base-package="com.enonic.cms.core.portal.datasource"/>
  <context:component-scan base-package="com.enonic.cms.core.portal.rendering"/>
  <context:component-scan base-package="com.enonic.cms.core.preview"/>
  <context:component-scan base-package="com.enonic.cms.core.search"/>
  <context:component-scan base-package="com.enonic.cms.core.security"/>
  <context:component-scan base-package="com.enonic.cms.core.structure.menuitem"/>
  <context:component-scan base-package="com.enonic.cms.core.timezone"/>
  <context:component-scan base-package="com.enonic.cms.store.resource"/>
  <context:component-scan base-package="com.enonic.cms.web.portal.image"/>
  <context:component-scan base-package="com.enonic.cms.web.portal.attachment"/>
  <context:component-scan base-package="com.enonic.cms.framework.cache.standard"/>

  <bean id="tightestCacheSettingsResolver"
        class="com.enonic.cms.core.TightestCacheSettingsResolver"/>

  <bean id="internalClientContentService"
        class="com.enonic.cms.core.client.InternalClientContentService">
    <property name="siteCachesService" ref="siteCachesService"/>
  </bean>

  <bean id="internalClientRenderService"
        class="com.enonic.cms.core.client.InternalClientRenderService"/>

  <bean id="portalRequestService" class="com.enonic.cms.core.portal.PortalRequestServiceImpl">
  </bean>

  <bean id="preferenceService" class="com.enonic.cms.core.preference.PreferenceServiceImpl"/>

  <bean id="resourceService" class="com.enonic.cms.core.resource.ResourceServiceImpl"/>

  <bean class="com.enonic.cms.core.client.LocalClientSetter">
    <property name="localClient" ref="localClient"/>
  </bean>

  <bean id="loginService" class="com.enonic.cms.core.login.LoginServiceImpl">
    <property name="autologinTimeoutInDays"
              value="1"/>
  </bean>

  <bean id="sitePathResolver" class="com.enonic.cms.web.portal.PortalSitePathResolver"/>

  <bean id="urlPathHelperManager" class="com.enonic.cms.core.UrlPathHelperManager">
    <property name="sitePropertiesService" ref="sitePropertiesService"/>
  </bean>

  <bean id="sitePropertiesService" class="com.enonic.cms.core.MockSitePropertiesService">
  </bean>

  <bean id="keyService" class="com.enonic.cms.itest.util.MockKeyService">
  </bean>

  <bean id="siteService" class="com.enonic.cms.core.structure.SiteServiceImpl">
    <property name="siteCachesService" ref="siteCachesService"/>
    <property name="siteContextManager">
      <bean class="com.enonic.cms.core.structure.SiteContextManager"/>
    </property>
    <property name="sitePropertiesService" ref="sitePropertiesService"/>
    <property name="siteDao" ref="siteDao"/>
    <property name="userDao" ref="userDao"/>
  </bean>

  <bean id="siteURLResolver" class="com.enonic.cms.core.SiteURLResolver">
    <property name="sitePathPrefix" value="/site"/>
    <property name="sitePropertiesService" ref="sitePropertiesService"/>
  </bean>

  <bean id="dataSourceService" class="com.enonic.cms.core.service.DataSourceServiceImpl">
    <property name="timeService" ref="timeService"/>
    <property name="sitePropertiesService" ref="sitePropertiesService"/>
  </bean>

  <bean id="portalAccessService" class="com.enonic.cms.core.portal.PortalAccessService"/>

  <bean id="pageRequestProcessorFactory" class="com.enonic.cms.core.portal.processor.PageRequestProcessorFactory"/>

  <bean id="localeResolverService"
        class="com.enonic.cms.core.resolver.locale.LocaleResolverServiceImpl">
    <property name="localeScriptResolver" ref="localeXsltScriptResolver"/>
  </bean>

  <bean id="localeXsltScriptResolver"
        class="com.enonic.cms.core.resolver.locale.LocaleXsltScriptResolver"/>

  <bean id="cookieOrSessionForcedResolverValueService"
        class="com.enonic.cms.core.resolver.ForceResolverValueServiceImpl"/>

  <bean id="sessionCachedResolverValueService"
        class="com.enonic.cms.core.resolver.CacheResolverValueServiceImpl"/>

  <bean id="resolverInputXMLCreator"
        class="com.enonic.cms.core.resolver.ResolverInputXMLCreator"/>

  <bean id="resolverXMLCreator"
        class="com.enonic.cms.core.resolver.ResolverHttpRequestInputXMLCreator"/>

  <bean id="resolverInputCreator"
        class="com.enonic.cms.core.resolver.ResolverHttpRequestInputCreator"/>

  <bean id="deviceClassXsltScriptResolver"
        class="com.enonic.cms.core.resolver.deviceclass.DeviceClassXsltScriptResolver"/>


  <!-- Possibly needs profile -->


  <bean class="com.enonic.cms.core.config.ConfigProperties"/>

  <bean id="verticalProperties" class="com.enonic.vertical.VerticalProperties"/>

  <bean id="blobStore" class="com.enonic.cms.framework.blob.memory.MemoryBlobStore"/>

  <bean id="localClient" class="com.enonic.cms.core.client.InternalClientImpl">
    <property name="clientForRemoteInvocations" value="false"/>
    <property name="internalClientContentService" ref="internalClientContentService"/>
    <property name="securityService" ref="securityService"/>
    <property name="userDao" ref="userDao"/>
    <property name="livePortalTraceService" ref="livePortalTraceService"/>
  </bean>

  <bean id="remoteClient" class="com.enonic.cms.core.client.InternalClientImpl">
    <property name="clientForRemoteInvocations" value="true"/>
    <property name="internalClientContentService" ref="internalClientContentService"/>
    <property name="securityService" ref="securityService"/>
    <property name="userDao" ref="userDao"/>
    <property name="livePortalTraceService" ref="livePortalTraceService"/>
  </bean>

  <bean id="livePortalTraceService" class="com.enonic.cms.core.portal.livetrace.LivePortalTraceServiceImpl">
    <property name="enabled" value="false"/>
    <property name="longestSize" value="1"/>
    <property name="historySize" value="1"/>
  </bean>

  <bean id="imageService" class="com.enonic.cms.core.portal.image.ImageServiceImpl">
    <property name="imageCache" ref="imageCache"/>
    <property name="blobStore" ref="blobStore"/>
  </bean>

  <bean id="contentIndexService" class="com.enonic.cms.itest.search.ContentIndexServiceTestWrapper"/>

  <bean id="siteCachesService" class="com.enonic.cms.itest.portal.cache.MockSiteCachesService"/>

  <bean id="timeService" class="com.enonic.cms.core.time.SystemTimeService"/>

  <bean id="deviceClassificationService"
        class="com.enonic.cms.core.resolver.deviceclass.DeviceClassResolverServiceImpl">
    <property name="deviceClassScriptResolver" ref="deviceClassXsltScriptResolver"/>
  </bean>

  <bean id="pluginManager" class="com.enonic.cms.itest.plugin.MockPluginManager"/>

  <bean id="urlDecodingUrlPathHelper" class="org.springframework.web.util.UrlPathHelper">
    <property name="urlDecode" value="true"/>
  </bean>

  <bean id="siteRedirectAndForwardHelper"
        class="com.enonic.cms.web.portal.SiteRedirectAndForwardHelper">
  </bean>

  <bean id="attachmentControllerForAdmin" class="com.enonic.cms.server.service.admin.mvc.controller.AttachmentController"/>

  <bean id="mimeTypeResolver" class="com.enonic.cms.framework.util.MimeTypeResolverImpl">
    <property name="mimetypesLocation" value="config/mimetypes.properties"/>
  </bean>

  <bean id="nodeSettingsBuilder" class="com.enonic.cms.itest.search.NodeTestSettingsBuilderImpl"/>

  <bean id="indexSettingsBuilder" class="com.enonic.cms.itest.search.IndexTestSettingsBuilderImpl"/>

</beans>
